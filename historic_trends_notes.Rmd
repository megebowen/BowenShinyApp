---
title: "historic_trends"
author: "Meghan Bowen"
date: "2/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Looking at Historic Trends in National Park Attendance

```{r load_packages}

library(tidyverse)
library(knitr)

```
## Part 1. Yearly Attendance

```{r load_clean_year_data}

yellowstone_vis_year <- read_csv("~/github/BowenShinyApp/Visitation_data/yellowstone_vis_year.csv")

#The yearly data as it stands goes from very small to very large
#Let's maybe mutate it to have a column of millions of visitors?

yellowstone_vis_year <- yellowstone_vis_year %>% 
  mutate(Visitors_Mil = RecreationVisitors/1000000)

```

```{r plot_year}

ggplot(yellowstone_vis_year, 
       aes(x=Year, y=Visitors_Mil))+
  geom_point() +
  labs(x= "Year",
       y= "Number of Visitors \n (millions)",
       title = "Yearly Visitors to Yellowstone",
       subtitle = "(1904-2018)") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))

```


## Part 2. Monthly Attendance

```{r load_clean_monthly_data}

# Need to clean like the HW/ARIMA data

yellowstone_vis_month <- read_csv("~/github/BowenShinyApp/Visitation_Data/yellowstone_vis_month.csv") %>%
  select(-Textbox5)
yellowstone_vis_month$Year <- as.factor(yellowstone_vis_month$Year)

gather_up <- gather(yellowstone_vis_month, key = "Month", value = "VisitorCount", JAN:DEC)
#gather_up <- as.data.frame(gather_up)
gather_up$Month <- as.factor(gather_up$Month)

months <- factor(levels = c("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"))
gather_up$Month <- fct_relevel(gather_up$Month, months)

gather_yellowstone <- gather_up[order(gather_up$Year),]

#The yearly data as it stands goes from very small to very large
#Let's maybe mutate it to have a column of millions of visitors?

yellowstone_vis_year <- yellowstone_vis_year %>% 
  mutate(Visitors_Mil = RecreationVisitors/1000000)

```

```{r plot_monthly}

ggplot(gather_yellowstone, 
       aes(x=Year, y=VisitorCount))+
  geom_point() 
  #labs(x= "Year",
       #y= "Number of Visitors \n (millions)",
       #title = "Yearly Visitors to Yellowstone",
       #subtitle = "(1904-2018)") +
  #theme_classic() +
  #theme(plot.title = element_text(hjust = 0.5),
   #     plot.subtitle = element_text(hjust = 0.5))

```